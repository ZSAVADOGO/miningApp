{% extends 'miningText/base.html' %}

{% block title %}Modifier {{ article.titre }}{% endblock %}

{% block content %}

<div class="bg-white rounded-xl shadow-md p-6 max-w-3xl mx-auto">

<h2 class="text-2xl font-bold mb-6 text-gray-800">
    Modifier "{{ article.titre }}"
</h2>

<form method="POST" enctype="multipart/form-data" class="space-y-4">
        {% csrf_token %}

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

            <!-- Auteur -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-1">
                    Titre
                </label>
                <input
                     type="text"
                name="titre"
                required
                value="{{ article.titre }}"
                class="w-full rounded-lg
                       border-2 border-gray-300
                       bg-gray-50
                       px-3 py-2
                       shadow-sm
                       focus:outline-none
                       focus:border-blue-500
                       focus:ring-2 focus:ring-blue-200
                       hover:border-gray-400
                       transition"
                placeholder="Titre de l’article"
                >
            </div>

            <!-- Date -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-1">
                    Auteur
                </label>
                <input
                    type="text"
                    name="auteur"
                    value="{{ article.auteur }}"
                    required
                    class="w-full rounded-lg
                           border-2 border-gray-300
                           bg-gray-50
                           px-3 py-2
                           shadow-sm
                           focus:outline-none
                           focus:border-blue-500
                           focus:ring-2 focus:ring-blue-200
                           hover:border-gray-400
                           transition"
                    placeholder="Auteur de l’article"
                >
            </div>

        </div>

        <!-- Contenu -->
        <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">
                Contenu
            </label>
            <textarea
                name="contenu"
                id="contenu"
                rows="4"
                required
                class="w-full rounded-lg
                       border-2 border-gray-300
                       bg-gray-50
                       px-3 py-2
                       shadow-sm
                       resize-none
                       focus:outline-none
                       focus:border-blue-500
                       focus:ring-2 focus:ring-blue-200
                       hover:border-gray-400
                       transition"
                placeholder="Écrivez ou collez le contenu de l’article ici…"
            >{{ article.contenu }}</textarea>

              <!-- On passe à 3 colonnes sur tablette/ordinateur (md:grid-cols-3) -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">

    <!-- Fichier : occupe 2 colonnes (md:col-span-2) -->
    <div class="md:col-span-2">
        <label class="block text-sm font-semibold text-gray-700 mb-1">
            Discours (fichier)
        </label>
        <input
            type="file"
            name="discours"
            id="discours"
            accept=".txt"
            class="block w-full text-sm text-gray-700
                   rounded-lg border-2 border-dashed border-gray-300
                   bg-gray-50
                   cursor-pointer
                   file:mr-3 file:py-2 file:px-3
                   file:rounded-md file:border-0
                   file:bg-blue-600 file:text-white
                   hover:file:bg-blue-700
                   hover:border-gray-400
                   transition"
        />
    </div>

    <!-- Date : occupe 1 seule colonne (comportement par défaut) -->
    <div class="md:col-span-1">
        <label class="block text-sm font-semibold text-gray-700 mb-1">
            Date de publication
        </label>
        <input
            type="date"
            name="date_publication"
            value="{{ article.date_publication|date:'Y-m-d' }}"
            required
            class="w-full rounded-lg
                   border-2 border-gray-300
                   bg-gray-50
                   px-3 py-2
                   shadow-sm
                   focus:ring-2 focus:ring-blue-200
                   focus:border-blue-500
                   transition"
        >
    </div>
</div>


        </div>


        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

            <!-- Source -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-1">
                    Source
                </label>
                <input
                    type="text"
                    name="source"
                    value="{{ article.source }}"
                    required
                    class="w-full rounded-lg
                           border-2 border-gray-300
                           bg-gray-50
                           px-3 py-2
                           shadow-sm
                           focus:outline-none
                           focus:border-blue-500
                           focus:ring-2 focus:ring-blue-200
                           hover:border-gray-400
                           transition"
                    placeholder="Auteur de l’article"
                >
            </div>

            <!-- Date -->
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-1">
                    Lien de la source
                </label>
                <input
                    type="text"
                    name="source_lien"
                    value="{{ article.source_lien }}"
                    required
                    class="w-full rounded-lg
                           border-2 border-gray-300
                           bg-gray-50
                           px-3 py-2
                           shadow-sm
                           focus:ring-2 focus:ring-blue-200
                           focus:border-blue-500
                           transition"
                >
            </div>

        </div>

       

        <!-- Actions -->
        <div class="flex justify-between items-center pt-4 border-t">
            <a
                href="{% url 'transform' %}"
                class="text-sm text-gray-600 hover:text-gray-900 transition"
            >
                ← Retour
            </a>

            <button
                type="submit"
                class="px-5 py-2 rounded-lg bg-blue-600 text-white
                       hover:bg-blue-700 active:scale-95
                       transition font-medium"
            >
                Modifier
            </button>
        </div>

        <script>
document.getElementById("discours").addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();

    reader.onload = function (e) {
        document.getElementById("contenu").value = e.target.result;
    };

    reader.readAsText(file, "UTF-8");
});
</script>


    </form>
</div>

{% comment %} <form method="POST" class="space-y-6 bg-white p-6 rounded-xl shadow">
    {% csrf_token %}

    <!-- Titre -->
    <div>
        <label for="titre" class="block text-sm font-medium text-gray-700 mb-1">
            Titre
        </label>
        <input
            type="text"
            id="titre"
            name="titre"
            value="{{ article.titre }}"
            required
            class="w-full rounded-lg border border-gray-300 px-4 py-2
                   focus:outline-none focus:ring-2 focus:ring-blue-500"
        >
    </div>

    <!-- Contenu -->
    <div>
        <label for="contenu" class="block text-sm font-medium text-gray-700 mb-1">
            Contenu
        </label>
        <textarea
            id="contenu"
            name="contenu"
            rows="6"
            required
            class="w-full rounded-lg border border-gray-300 px-4 py-2
                   focus:outline-none focus:ring-2 focus:ring-blue-500"
        >{{ article.contenu }}</textarea>
    </div>

    <!-- Auteur -->
    <div>
        <label for="auteur" class="block text-sm font-medium text-gray-700 mb-1">
            Auteur
        </label>
        <input
            type="text"
            id="auteur"
            name="auteur"
            value="{{ article.auteur }}"
            required
            class="w-full rounded-lg border border-gray-300 px-4 py-2
                   focus:outline-none focus:ring-2 focus:ring-blue-500"
        >
    </div>

    <!-- Actions -->
    <div class="flex gap-4">
        <button
            type="submit"
            class="bg-green-600 text-white px-6 py-2 rounded-lg
                   hover:bg-green-700 transition"
        >
            Enregistrer
        </button>

        <a
            href="{% url 'detail' article.id %}"
            class="bg-gray-200 text-gray-800 px-6 py-2 rounded-lg
                   hover:bg-gray-300 transition"
        >
            Annuler
        </a>
    </div>
</form> {% endcomment %}
{% endblock %}
